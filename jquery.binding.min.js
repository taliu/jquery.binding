(function(f){function k(a,c,b){this.propertyName=a;this.newValue=c;this.oldValue=b}function l(a){this.Model=a;this.callbacks=f.Callbacks()}function j(a,c,b,g,d){c.onFire(function(c,e){if(e.propertyName==b)if("val"==d)a.val()!=e.newValue&&a.val(e.newValue);else if("html"==d||"text"==d)a[d](e.newValue);else a[d](g,e.newValue)})}function i(a,c,b){var g=m.get(c),d;for(d in b)if(b.hasOwnProperty(d)){var h=b[d];switch(d.toLowerCase()){case "value":a.on("keyup mouseup change",{dependObj:g,proName:h},function(a){var b=
f(this).val();a.data.dependObj.setProperty(a.data.proName,b)});j(a,g,h,d,"val");break;case "html":case "text":j(a,g,h,d,d);break;default:var e=d.split("."),i="css";e[1]&&(i=e[0],d=e[1]);j(a,g,h,d,i)}g.fire(c,new k(h,g.getProperty(h)))}}l.prototype={setProperty:function(a,c){var b=this.getProperty(a);b!==c&&(/\.|\[/.test(a)?(new Function("model","val","model."+a+"=val"))(this.Model,c):this.Model[a]=c,this.fire(this.Model,new k(a,c,b)))},getProperty:function(a){return/\.|\[|\(/.test(a)?(new Function("model",
"return model."+a))(this.Model):this.Model[a]},fire:function(a,c){this.callbacks.fire(a,c)},onFire:function(a){this.callbacks.add(a)}};var m=new function(){var a=[];this.find=function(c){for(var b=a.length;b--;)if(a[b].Model===c)return a[b];return null};this.get=function(c){var b=this.find(c);b||(b=new l(c),a.push(b));return b}};f.fn.bindData=function(a,c){var b=this.attr("mapping");b?(b=f.extend((new Function("return "+b))(),c),f.isEmptyObject(b)||i(this,a,b)):f.isEmptyObject(c)||i(this,a,c);this.find("[mapping]").each(function(){var b=
f(this),c=b.attr("mapping");if(c){c=(new Function("return "+c))();f.isEmptyObject(c)||i(b,a,c)}});return this}})(jQuery);
